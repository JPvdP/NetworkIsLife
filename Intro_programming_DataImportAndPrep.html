<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>NetworkIsLife – intro_programming_dataimportandprep</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">NetworkIsLife</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">Programming</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Intro_programming_basic_operations.html">Intro to Programming</a></li><li class="breadcrumb-item"><a href="./Intro_programming_DataImportAndPrep.html">Data Import and preparation</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Network Analysis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Network_analysis_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The basics of Network Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Text_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Textual Networks</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Intro to Programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro_programming_basic_operations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic Operations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro_programming_DataImportAndPrep.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Data Import and preparation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro_programming_Databasemanip.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Database Manipulation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro_programming_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Making functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro_programming_loops_ifelse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Loops, if-else and Mapping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Intro_programming_visualisation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data visualisation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Text Mining</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./feature_extraction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feature Extraction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Topic_modelling_lda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Topic Modelling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Topic_modelling_bertopic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Topic modelling with Bertopic</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NER.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Named Entity Recognition</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Text_networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Textual Networks</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-import-and-preparation" id="toc-data-import-and-preparation" class="nav-link active" data-scroll-target="#data-import-and-preparation">Data Import and preparation</a></li>
  <li><a href="#importing-in-r" id="toc-importing-in-r" class="nav-link" data-scroll-target="#importing-in-r">Importing in R</a>
  <ul class="collapse">
  <li><a href="#txt-csv-tsv" id="toc-txt-csv-tsv" class="nav-link" data-scroll-target="#txt-csv-tsv">TXT, CSV, TSV</a></li>
  <li><a href="#xls-xlsx" id="toc-xls-xlsx" class="nav-link" data-scroll-target="#xls-xlsx">XLS, XLSX</a></li>
  <li><a href="#rdata" id="toc-rdata" class="nav-link" data-scroll-target="#rdata">rdata</a></li>
  <li><a href="#bib" id="toc-bib" class="nav-link" data-scroll-target="#bib">Bib</a></li>
  <li><a href="#json" id="toc-json" class="nav-link" data-scroll-target="#json">json</a></li>
  <li><a href="#jsonl" id="toc-jsonl" class="nav-link" data-scroll-target="#jsonl">jsonl</a></li>
  </ul></li>
  <li><a href="#importing-in-python" id="toc-importing-in-python" class="nav-link" data-scroll-target="#importing-in-python">Importing in Python</a>
  <ul class="collapse">
  <li><a href="#txt-csv-tsv-1" id="toc-txt-csv-tsv-1" class="nav-link" data-scroll-target="#txt-csv-tsv-1">TXT, CSV, TSV</a></li>
  <li><a href="#xlsxlsx-excel-data-format" id="toc-xlsxlsx-excel-data-format" class="nav-link" data-scroll-target="#xlsxlsx-excel-data-format">XLS/XLSX (excel data format)</a></li>
  <li><a href="#json-and-jsonl" id="toc-json-and-jsonl" class="nav-link" data-scroll-target="#json-and-jsonl">Json and jsonl</a></li>
  </ul></li>
  <li><a href="#data-conformity-and-preparation" id="toc-data-conformity-and-preparation" class="nav-link" data-scroll-target="#data-conformity-and-preparation">Data conformity and preparation</a>
  <ul class="collapse">
  <li><a href="#data-conformity-in-r" id="toc-data-conformity-in-r" class="nav-link" data-scroll-target="#data-conformity-in-r">Data conformity in R</a>
  <ul class="collapse">
  <li><a href="#checking-data-types" id="toc-checking-data-types" class="nav-link" data-scroll-target="#checking-data-types">Checking data types</a></li>
  <li><a href="#extract-substrings" id="toc-extract-substrings" class="nav-link" data-scroll-target="#extract-substrings">Extract substrings</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values">Missing values</a></li>
  </ul></li>
  <li><a href="#data-conformity-in-python" id="toc-data-conformity-in-python" class="nav-link" data-scroll-target="#data-conformity-in-python">Data conformity in Python</a>
  <ul class="collapse">
  <li><a href="#checking-data-types-1" id="toc-checking-data-types-1" class="nav-link" data-scroll-target="#checking-data-types-1">Checking data types</a></li>
  <li><a href="#data-transformation-1" id="toc-data-transformation-1" class="nav-link" data-scroll-target="#data-transformation-1">Data transformation</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="data-import-and-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-import-and-preparation">Data Import and preparation</h2>
<p>How to import different dataformats in python and R.</p>
</section>
<section id="importing-in-r" class="level1">
<h1>Importing in R</h1>
<section id="txt-csv-tsv" class="level2">
<h2 class="anchored" data-anchor-id="txt-csv-tsv">TXT, CSV, TSV</h2>
<p>For the import of data from <em>txt</em>, <em>csv</em> or <em>tsv</em> formats we will use the <strong>read_delim()</strong> function from the readr package. The main difference between these data formats resides in the separator of the data. For txt data, this is often undefined and needs to be specified by the user. The main arguments of the <strong>read_delim()</strong> are the file and the separator. The separator is the character string that defines where a line should be cut. For example, if our raw data looks like this:</p>
<p>Year;Class;Value<br> 2002;B60C;42<br> 2003;B29K;21<br> 2009;C08K;12<br></p>
<p>Then we see that each column is separated by a “;”. By splitting the data whenever there is a “;” we create the following dataframe:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Year</th>
<th style="text-align: center;">Class</th>
<th style="text-align: center;">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">2002</td>
<td style="text-align: center;">B60C</td>
<td style="text-align: center;">42</td>
</tr>
<tr class="even">
<td style="text-align: center;">2003</td>
<td style="text-align: center;">B29K</td>
<td style="text-align: center;">21</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2009</td>
<td style="text-align: center;">C08K</td>
<td style="text-align: center;">12</td>
</tr>
</tbody>
</table>
<p>Seperators that we commonly find in data are the semicolon: <strong>“;”</strong>, the comma: <strong>“,”</strong>, the vertical bar (or pipe) <strong>“|”</strong>, the space **” “, and tabs which are coded with**”\t”.</p>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pay Attention
</div>
</div>
<div class="callout-body-container callout-body">
<p>Even though csv stands for Comma Separated Values, this does not mean that the separator is always a comma, often enough it is in fact a semicolon. Always check your data to make sure you have the right one.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># csv and various other separators</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(file, <span class="at">sep =</span> <span class="st">","</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(file, <span class="at">sep =</span> <span class="st">"|"</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(file, <span class="at">sep =</span> <span class="st">";"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># txt (space separated values)</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(file, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># tsv (tab separated values)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(file, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="xls-xlsx" class="level2">
<h2 class="anchored" data-anchor-id="xls-xlsx">XLS, XLSX</h2>
<p>Excel files can also easily be importanted into R with the the <strong>readxl</strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="st">"sample_data.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 3
  Pat_num       Year Domain
  &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt; 
1 WO200214562   2002 B60C  
2 WO2023738962  2023 B60C  
3 EP2023778962  2023 B29D  
4 FR2019272698  2019 C08K  
5 FR201922671   2019 C08K  </code></pre>
</div>
</div>
</section>
<section id="rdata" class="level2">
<h2 class="anchored" data-anchor-id="rdata">rdata</h2>
<p><img src="Open_rdata_file.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use import function in rstudio, or double click</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="bib" class="level2">
<h2 class="anchored" data-anchor-id="bib">Bib</h2>
<p>.bib files are a popular bibliographic data format. This data can be imported and transformed into a dataframe using the <strong>bibliometrix</strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bibliometrix)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">convert2df</span>(file, <span class="at">dbsource =</span> <span class="st">"scopus"</span>, <span class="at">format =</span> <span class="st">"bibtex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pay Attention
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <strong>bibliometrix</strong> package is designed for bibliometic analysis, it might change the names of the columns and the format of some of the data to adjust to what it is supped to do.</p>
</div>
</div>
</section>
<section id="json" class="level2">
<h2 class="anchored" data-anchor-id="json">json</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the path to the JSON file</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>json_file <span class="ot">&lt;-</span> <span class="st">"example_1.json"</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the JSON file</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(json_file)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the imported JSON data</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$fruit
[1] "Apple"

$size
[1] "Large"

$color
[1] "Red"</code></pre>
</div>
</div>
</section>
<section id="jsonl" class="level2">
<h2 class="anchored" data-anchor-id="jsonl">jsonl</h2>
<p>jsonl files are a list of json files. We find this format for exampl in the lens.org database. Since each row is a json, we first read the files as text files and then apply the fromJSON function to extract the information. The result is a list of data objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tmp<span class="ot">&lt;-</span><span class="fu">readLines</span>(<span class="st">"data_test.jsonl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in readLines("data_test.jsonl"): incomplete final line found on
'data_test.jsonl'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">lapply</span>(tmp, jsonlite<span class="sc">::</span>fromJSON)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<summary>
Click here to see output
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r foldable code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tmp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]]$lens_id
[1] "000-136-263-451-165"

[[1]]$title
[1] "The influence of displaced femoral neck fractures on the surgical incision for hemiarthroplasty using the Hardinge approach"

[[1]]$publication_type
[1] "journal article"

[[1]]$year_published
[1] 2002

[[1]]$date_published_parts
[1] 2002    1

[[1]]$created
[1] "2018-05-12T00:07:16.368000+00:00"

[[1]]$external_ids
   type              value
1 magid         2083116342
2   doi 10.1007/bf03170381

[[1]]$authors
  first_name last_name initials               ids
1         M.    Yousef        M magid, 2518579655
2         E. Masterson        E magid, 2607514729
                                                                                                                                                                                    affiliations
1 Mid-Western Regional Hospital, Department of Orthopaedic Surgery, Mid-Western Regional Hospital, Limerick, Ireland., magid, grid, ror, 2799956115, grid.415964.b, 00r5kgd36, grid.415964.b, IE
2 Mid-Western Regional Hospital, Department of Orthopaedic Surgery, Mid-Western Regional Hospital, Limerick, Ireland., magid, grid, ror, 2799956115, grid.415964.b, 00r5kgd36, grid.415964.b, IE

[[1]]$source
[[1]]$source$title
[1] "Irish Journal of Medical Science"

[[1]]$source$type
[1] "Journal"

[[1]]$source$publisher
[1] "Springer Science and Business Media LLC"

[[1]]$source$issn
        type    value
1      print 00211265
2 electronic 18634362
3      print 03321029
4      print 0790231x
5      print 07902328

[[1]]$source$country
[1] "Ireland"

[[1]]$source$asjc_codes
[1] "2700"

[[1]]$source$asjc_subjects
[1] "General Medicine"


[[1]]$fields_of_study
[1] "Surgery"                "Surgical incision"      "Hardinge approach"     
[4] "Femoral Neck Fractures" "Medicine"              

[[1]]$volume
[1] "171"

[[1]]$issue
[1] "1"

[[1]]$languages
[1] "en"

[[1]]$source_urls
  type                                                          url
1 html         https://link.springer.com/article/10.1007/BF03170381
2 &lt;NA&gt; https://link.springer.com/content/pdf/10.1007/BF03170381.pdf

[[1]]$start_page
[1] "31"

[[1]]$end_page
[1] "31"

[[1]]$author_count
[1] 2


[[2]]
[[2]]$lens_id
[1] "000-150-493-965-760"

[[2]]$title
[1] "Peroxidase activity in soybeans following inoculation with Phytophthora sojae."

[[2]]$publication_type
[1] "journal article"

[[2]]$year_published
[1] 2006

[[2]]$date_published_parts
[1] 2006    1

[[2]]$created
[1] "2018-05-12T03:57:41.820000+00:00"

[[2]]$external_ids
   type                     value
1   doi 10.1007/s11046-005-0721-y
2  pmid                  16389483
3 magid                2006874664

[[2]]$authors
  first_name last_name initials               ids
1    Jose C.    Melgar       JC magid, 2634470543
2  Thomas S.     Abney       TS magid, 2677788953
3 Richard A.  Vierling       RA magid, 1981461697
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       affiliations
1                                                                                                                                                                                                                                                                      Purdue University, Botany and Plant Pathology Department, Purdue University, West Lafayette, IN 47907, USA., magid, grid, fundref, wikidata, ror, 219193219, grid.169077.e, 100006377, q217741, 02dqehb95, grid.169077.e, US
2 United States Department of Agriculture, Agricultural Research Service, Crop Production and Pathology Unit, Agricultural Research Service, U.S. Department of Agriculture, West Lafayette, USA, Crop Production and Pathology Unit, Agricultural Research Service, U.S. Department of Agriculture, West Lafayette, USA, magid, grid, fundref, ror, 1336096307, grid.417548.b, 100000199, 01na82s61, grid, fundref, ror, grid.463419.d, 100007917, 02d2m2044, grid.417548.b, grid.463419.d, US, US
3                                                                                                                                                                                                                                                           Purdue University, Botany &amp; Plant Pathology Department and Agronomy Department, Purdue University, West Lafayette, USA, magid, grid, fundref, wikidata, ror, 219193219, grid.169077.e, 100006377, q217741, 02dqehb95, grid.169077.e, US

[[2]]$source
[[2]]$source$title
[1] "Mycopathologia"

[[2]]$source$type
[1] "Journal"

[[2]]$source$publisher
[1] "Springer Science and Business Media LLC"

[[2]]$source$issn
        type    value
1      print 0301486x
2 electronic 15730832

[[2]]$source$country
[1] "Netherlands"

[[2]]$source$asjc_codes
[1] "2404" "2402" "1110" "1102" "3401"

[[2]]$source$asjc_subjects
[1] "Agronomy and Crop Science"             
[2] "Applied Microbiology and Biotechnology"
[3] "Microbiology"                          
[4] "Plant Science"                         
[5] "Veterinary (miscalleneous)"            
[6] "Veterinary (miscellaneous)"            


[[2]]$fields_of_study
[1] "Gene"               "Horticulture"       "Peroxidase"        
[4] "Inoculation"        "Phytophthora sojae" "Phytophthora"      
[7] "Botany"             "Biology"           

[[2]]$volume
[1] "161"

[[2]]$issue
[1] "1"

[[2]]$languages
[1] "en"

[[2]]$references
               lens_id
1  004-042-571-377-321
2  005-317-066-947-203
3  020-042-216-048-371
4  032-446-103-377-888
5  034-601-439-886-731
6  062-700-560-648-136
7  066-443-980-641-011
8  088-133-232-334-221
9  106-456-828-269-00X
10 168-522-110-138-272
11 192-341-655-765-695

[[2]]$mesh_terms
    mesh_heading       qualifier_name mesh_id qualifier_id
1    Peroxidases           metabolism D010544      Q000378
2   Phytophthora growth &amp; development D010838      Q000254
3 Plant Diseases         microbiology D010935      Q000382
4 Plant Proteins           metabolism D010940      Q000378
5      Seedlings           enzymology D036226      Q000201
6       Soybeans           enzymology D013025      Q000201

[[2]]$chemicals
  substance_name registry_number mesh_id
1 Plant Proteins               0 D010940
2    Peroxidases     EC 1.11.1.- D010544

[[2]]$source_urls
  type                                                         url
1 html https://link.springer.com/article/10.1007/s11046-005-0721-y
2 html                https://www.ncbi.nlm.nih.gov/pubmed/16389483
3 html                  https://europepmc.org/article/MED/16389483

[[2]]$references_count
[1] 11

[[2]]$scholarly_citations_count
[1] 12

[[2]]$start_page
[1] "37"

[[2]]$end_page
[1] "42"

[[2]]$scholarly_citations
 [1] "027-668-154-909-322" "031-369-742-281-943" "034-566-544-087-375"
 [4] "041-477-983-598-256" "041-552-411-498-281" "042-968-597-273-042"
 [7] "045-790-949-621-105" "062-868-088-589-29X" "107-788-244-832-10X"
[10] "132-744-976-798-754" "153-187-658-237-284" "160-817-571-772-644"

[[2]]$author_count
[1] 3


[[3]]
[[3]]$lens_id
[1] "000-161-224-328-417"

[[3]]$title
[1] "Astronomy: Planets in chaos"

[[3]]$publication_type
[1] "journal article"

[[3]]$year_published
[1] 2014

[[3]]$date_published
[1] "2014-07-02T00:00:00.000000+00:00"

[[3]]$date_published_parts
[1] 2014    7    2

[[3]]$created
[1] "2018-05-12T07:57:28.771000+00:00"

[[3]]$external_ids
   type           value
1 magid      2014980602
2  pmid        24990727
3   doi 10.1038/511022a

[[3]]$open_access
[[3]]$open_access$colour
[1] "bronze"


[[3]]$authors
  first_name  last_name initials               ids affiliations
1        Ann Finkbeiner        A magid, 2633978770         NULL

[[3]]$source
[[3]]$source$title
[1] "Nature"

[[3]]$source$type
[1] "Journal"

[[3]]$source$publisher
[1] "Springer Science and Business Media LLC"

[[3]]$source$issn
        type    value
1 electronic 14764687
2      print 00280836

[[3]]$source$country
[1] "United Kingdom"

[[3]]$source$asjc_codes
[1] "1000"

[[3]]$source$asjc_subjects
[1] "Multidisciplinary"


[[3]]$fields_of_study
[1] "Exoplanetology"           "Physics"                 
[3] "Astronomy"                "Star (graph theory)"     
[5] "Planetary science"        "CHAOS (operating system)"
[7] "Planet"                   "Astrobiology"            

[[3]]$volume
[1] "511"

[[3]]$issue
[1] "7507"

[[3]]$languages
[1] "en"

[[3]]$references
              lens_id
1 002-401-641-595-121
2 002-872-990-703-478
3 031-880-830-498-497
4 082-960-570-095-64X
5 149-177-951-839-803

[[3]]$source_urls
     type                                                           url
1 unknown                   https://www.nature.com/articles/511022a.pdf
2    html                       https://www.nature.com/articles/511022a
3    html http://ui.adsabs.harvard.edu/abs/2014Natur.511...22F/abstract
4    html                    https://europepmc.org/article/MED/24990727

[[3]]$abstract
[1] "The discovery of thousands of star systems wildly different from our own has demolished ideas about how planets form. Astronomers are searching for a whole new theory."

[[3]]$references_count
[1] 5

[[3]]$scholarly_citations_count
[1] 3

[[3]]$start_page
[1] "22"

[[3]]$end_page
[1] "24"

[[3]]$scholarly_citations
[1] "020-515-110-880-837" "084-952-180-195-058" "086-879-116-036-663"

[[3]]$author_count
[1] 1

[[3]]$is_open_access
[1] TRUE</code></pre>
</div>
</div>
</details>
</section>
</section>
<section id="importing-in-python" class="level1">
<h1>Importing in Python</h1>
<section id="txt-csv-tsv-1" class="level2">
<h2 class="anchored" data-anchor-id="txt-csv-tsv-1">TXT, CSV, TSV</h2>
<p>package required <strong>openpyxl</strong>, <strong>pandas</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Import CSV File</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>csv_file <span class="op">=</span> <span class="st">"sample_data.csv"</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>df_csv <span class="op">=</span> pd.read_csv(csv_file, sep <span class="op">=</span> <span class="st">";"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Import TXT File (Space-Separated)</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>txt_file <span class="op">=</span> <span class="st">"sample_data.txt"</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>df_txt <span class="op">=</span> pd.read_csv(txt_file, sep<span class="op">=</span><span class="st">" "</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Import TSV File (Tab-Separated)</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>tsv_file <span class="op">=</span> <span class="st">"sample_data.tsv"</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>df_tsv <span class="op">=</span> pd.read_csv(tsv_file, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Import XLS (Excel) File</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>xls_file <span class="op">=</span> <span class="st">"sample_data.xlsx"</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>df_xls <span class="op">=</span> pd.read_excel(xls_file)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_xls)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Import JSON File</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="co">#json_file = "sample_data.json"</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="co">#df_json = pd.read_json(json_file)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="xlsxlsx-excel-data-format" class="level2">
<h2 class="anchored" data-anchor-id="xlsxlsx-excel-data-format">XLS/XLSX (excel data format)</h2>
<p>Excel files can be imported with help from the pandas package. If you do not specify a sheet to import, the first sheet will be taken. You can specify the sheet with the argument: <em>sheet_name=‘Sheet1’</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Import XLS (Excel) File</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>df_xls <span class="op">=</span> pd.read_excel(<span class="st">"sample_data.xlsx"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_xls)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="json-and-jsonl" class="level2">
<h2 class="anchored" data-anchor-id="json-and-jsonl">Json and jsonl</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import JSON File</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#json_file = "sample_data.json"</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#df_json = pd.read_json(json_file)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import jsonl</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> jsonlines</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># First we open the file and provide it with a name (data_from_jsonl)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> jsonlines.<span class="bu">open</span>(<span class="st">'data_test.jsonl'</span>, <span class="st">'r'</span>) <span class="im">as</span> data_from_jsonl:</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>      <span class="co"># extract the information from each row and put into object</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>     results <span class="op">=</span> [row <span class="cf">for</span> row <span class="kw">in</span> data_from_jsonl] </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>data_from_jsonl.close() <span class="co"># close the file again</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-conformity-and-preparation" class="level1">
<h1>Data conformity and preparation</h1>
<section id="data-conformity-in-r" class="level2">
<h2 class="anchored" data-anchor-id="data-conformity-in-r">Data conformity in R</h2>
<p>Before you start working on your analysis, you want to make sure the data is conform to your expectations. This means:</p>
<ul>
<li><p>The number of observation is correct, and the variables you need are included.</p></li>
<li><p>Making sure each column is of the right type (years are dates, text are factors, numbers are integers or reals, …)</p></li>
<li><p>There are no trailing spaces</p></li>
<li><p><strong>“.”</strong> and <strong>“,”</strong> aren’t mixed up</p></li>
<li><p>The units of measurement are correct (km vs.&nbsp;miles, K€ vs 1.000, celsius vs fahrenheit etc.)</p></li>
<li><p>Any missing values have been dealt with, or you have a valid reason to ignore them</p></li>
<li><p>headers are easy to use (no spaces or other characters that will make your life difficult).</p></li>
</ul>
<p>In this section we will look into checking your data and adjusting it in preparation of your analysis.</p>
<section id="checking-data-types" class="level3">
<h3 class="anchored" data-anchor-id="checking-data-types">Checking data types</h3>
<p>There are many different data formats. Most frequently we encounter numbers, strings, factors, dates and booleans. Consider the following dataset:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">ID</th>
<th style="text-align: center;">Year</th>
<th style="text-align: center;">Cool Domain</th>
<th style="text-align: center;">Frequency</th>
<th style="text-align: center;">Alive</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">2002</td>
<td style="text-align: center;">B60C</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID2</td>
<td style="text-align: center;">2003</td>
<td style="text-align: center;">B29K</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ID3</td>
<td style="text-align: center;">2009</td>
<td style="text-align: center;">C08K</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">TRUE</td>
</tr>
</tbody>
</table>
<p>The first column has textual data that is used as a key for each row. The Year should be considered either as an integer or a date. This will depend upon the type of analysis you want to perform. Specifically time series analysis will require this to be a date, while it’s enough for other analyses to ensure that it is an integer. The most common issue with this type of observation is that the year is considered as text instead of a number. If you see any ““” next to your numbers this is a bad sign which indicates that it is in fact, text.</p>
<p>The “Cool Domain” contains classifications which we want to be textual values. “Frequency” will need to be an integer while “Alive” we want to be a boolean. For each of the formats there is a function to test whether or not the format is the one we expect. These functions are usually in the form of <strong>is.numerical()</strong>, <strong>is.logical()</strong>, <strong>is.character()</strong>. The argument is then simply the column of the dataframe or an observation. Suppose we create the previous dataframe in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="fu">c</span>(<span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"ID3"</span>), <span class="at">Year =</span> <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">2003</span>, <span class="dv">2009</span>), <span class="st">`</span><span class="at">Cool Domain</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"B60C"</span>, <span class="st">"B29K"</span>,<span class="st">"B29K"</span>), <span class="at">Frequency =</span> <span class="fu">c</span>(<span class="dv">42</span>, <span class="dv">21</span>, <span class="dv">12</span>),<span class="at">Alive =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ID Year Cool.Domain Frequency Alive
1 ID1 2002        B60C        42  TRUE
2 ID2 2003        B29K        21 FALSE
3 ID3 2009        B29K        12  TRUE</code></pre>
</div>
</div>
<p>We can then check the format of each variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.numeric</span>(data<span class="sc">$</span>Frequency)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.character</span>(data<span class="sc">$</span>ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.logical</span>(data<span class="sc">$</span>Alive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>This can also be done in a more consise way with the <strong>summary()</strong> function. This compute, for each of the columns, some statistics and provides the class of the class of the variables. This comes in handy as it allows us verify not only the class of the variables but also the distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ID                 Year      Cool.Domain          Frequency   
 Length:3           Min.   :2002   Length:3           Min.   :12.0  
 Class :character   1st Qu.:2002   Class :character   1st Qu.:16.5  
 Mode  :character   Median :2003   Mode  :character   Median :21.0  
                    Mean   :2005                      Mean   :25.0  
                    3rd Qu.:2006                      3rd Qu.:31.5  
                    Max.   :2009                      Max.   :42.0  
   Alive        
 Mode :logical  
 FALSE:1        
 TRUE :2        
                
                
                </code></pre>
</div>
</div>
<p>When the variable is a character, the output shows the length (number of observations) and the class. For numeric variables the output shows the distribution of the data (min, max, etc.). Not all text variables are created equal. It is possible to ensure that text is considered as a factor. A factor is basically a category, dummy variables in regressions are usually programmed as factors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="fu">c</span>(<span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"ID3"</span>, <span class="st">"ID4"</span>), <span class="at">Year =</span> <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">2003</span>, <span class="dv">2009</span>, <span class="dv">2010</span>), <span class="st">`</span><span class="at">Cool Domain</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"B60C"</span>, <span class="st">"B29K"</span>,<span class="st">"B29K"</span>, <span class="st">"B60C"</span>), <span class="at">Frequency =</span> <span class="fu">c</span>(<span class="dv">42</span>, <span class="dv">21</span>, <span class="dv">12</span>, <span class="cn">NA</span>),<span class="at">Alive =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>), <span class="at">Country =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"France"</span>, <span class="st">"France"</span>, <span class="st">"Germany"</span>, <span class="st">"Netherlands"</span>)))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ID                 Year      Cool.Domain          Frequency   
 Length:4           Min.   :2002   Length:4           Min.   :12.0  
 Class :character   1st Qu.:2003   Class :character   1st Qu.:16.5  
 Mode  :character   Median :2006   Mode  :character   Median :21.0  
                    Mean   :2006                      Mean   :25.0  
                    3rd Qu.:2009                      3rd Qu.:31.5  
                    Max.   :2010                      Max.   :42.0  
                                                      NA's   :1     
   Alive                Country 
 Mode :logical   France     :2  
 FALSE:3         Germany    :1  
 TRUE :1         Netherlands:1  
                                
                                
                                
                                </code></pre>
</div>
</div>
<p>In this output we see that the <strong>NA</strong> is taken into account and counted separedly in the date. It also shows that <em>“Country”</em> is considered as a factor. The summary then shows how many observations we have for each of the factors.</p>
<p>Given that we created the dataframe ourselves we can be relatively sure that the data was is the right format. However, often enough when we download data from online sources, we run into issues. If the format is not as expected there are different functions that allows us to transform the format of the data. Mainly we use <strong>as.numeric()</strong>, <strong>as.character()</strong> and <strong>as.logical()</strong>. These functions require only one argument which is the column we are trying to convert:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform into a numeric value</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Frequency <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>Frequency)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># transform in to a character string</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Frequency <span class="ot">&lt;-</span> <span class="fu">as.character</span>(data<span class="sc">$</span>ID)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># transform into a boolean</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Frequency <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(data<span class="sc">$</span>Alive)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As an example consider we will create a dataframe that mimics data that was not imported correctly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Messy_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="fu">c</span>(<span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"ID3"</span>, <span class="st">"ID4"</span>), <span class="at">Year =</span> <span class="fu">c</span>(<span class="st">"2002"</span>, <span class="st">"2003"</span>, <span class="st">"2009"</span>, <span class="st">"2010"</span>), <span class="st">`</span><span class="at">Cool Domain</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"B60C"</span>, <span class="st">"B29K"</span>,<span class="st">"B29K"</span>, <span class="st">"B60C"</span>), <span class="at">Frequency =</span> <span class="fu">c</span>(<span class="st">"42"</span>, <span class="st">"21"</span>, <span class="st">"12"</span>, <span class="st">"NA"</span>),<span class="at">Alive =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>, <span class="st">"FALSE"</span>, <span class="st">"FALSE"</span>), <span class="at">Country =</span> <span class="fu">c</span>(<span class="st">"France"</span>, <span class="st">"France"</span>, <span class="st">"Germany"</span>, <span class="st">"Netherlands"</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Messy_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ID                Year           Cool.Domain         Frequency        
 Length:4           Length:4           Length:4           Length:4          
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
    Alive             Country         
 Length:4           Length:4          
 Class :character   Class :character  
 Mode  :character   Mode  :character  </code></pre>
</div>
</div>
<p>The output clearly shows that all variables are considered as characters which we do not want. We cannot comput the average on the Frequency while R thinks that it is text. This also shows that there is a difference between the string NA (“NA”) and the operator NA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform into a numerical value</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>Messy_data<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Messy_data<span class="sc">$</span>Year)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>Messy_data<span class="sc">$</span>Frequency <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Messy_data<span class="sc">$</span>Frequency)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform into a boolean</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>Messy_data<span class="sc">$</span>Alive <span class="ot">&lt;-</span> <span class="fu">as.logical</span>(Messy_data<span class="sc">$</span>Alive)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># transform into a factor (category)</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>Messy_data<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Messy_data<span class="sc">$</span>Country)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Messy_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ID                 Year      Cool.Domain          Frequency   
 Length:4           Min.   :2002   Length:4           Min.   :12.0  
 Class :character   1st Qu.:2003   Class :character   1st Qu.:16.5  
 Mode  :character   Median :2006   Mode  :character   Median :21.0  
                    Mean   :2006                      Mean   :25.0  
                    3rd Qu.:2009                      3rd Qu.:31.5  
                    Max.   :2010                      Max.   :42.0  
                                                      NA's   :1     
   Alive                Country 
 Mode :logical   France     :2  
 FALSE:3         Germany    :1  
 TRUE :1         Netherlands:1  
                                
                                
                                
                                </code></pre>
</div>
</div>
<p>Now that our data has the right format and we are sure we have all the observations we might want to do some work to normalise the column names. This is done to make programming and refercing the columns easier. Whenever the is a space in the name of the column, we need to refer to the column using <strong>`Column name with spaces`</strong> which is not ideal. It’s generally good practice to not have any spaces. We can use the <strong>colnames()</strong> function to change some (or all of the column names).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change on column name:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Messy_data)[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="st">"Domain"</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># change multiple names:</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Messy_data)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>)] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Identifier"</span>, <span class="st">"Date"</span>, <span class="st">"Active"</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Messy_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Identifier             Date         Domain            Frequency   
 Length:4           Min.   :2002   Length:4           Min.   :12.0  
 Class :character   1st Qu.:2003   Class :character   1st Qu.:16.5  
 Mode  :character   Median :2006   Mode  :character   Median :21.0  
                    Mean   :2006                      Mean   :25.0  
                    3rd Qu.:2009                      3rd Qu.:31.5  
                    Max.   :2010                      Max.   :42.0  
                                                      NA's   :1     
   Active               Country 
 Mode :logical   France     :2  
 FALSE:3         Germany    :1  
 TRUE :1         Netherlands:1  
                                
                                
                                
                                </code></pre>
</div>
</div>
<p>The <strong>Janitor</strong> package offers an automated solution for many header issues.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>Messy_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="fu">c</span>(<span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"ID3"</span>, <span class="st">"ID4"</span>), <span class="at">Year =</span> <span class="fu">c</span>(<span class="st">"2002"</span>, <span class="st">"2003"</span>, <span class="st">"2009"</span>, <span class="st">"2010"</span>), <span class="st">`</span><span class="at">Cool Domain</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"B60C"</span>, <span class="st">"B29K"</span>,<span class="st">"B29K"</span>, <span class="st">"B60C"</span>), <span class="at">Frequency =</span> <span class="fu">c</span>(<span class="st">"42"</span>, <span class="st">"21"</span>, <span class="st">"12"</span>, <span class="st">"NA"</span>),<span class="at">Alive =</span> <span class="fu">c</span>(<span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>, <span class="st">"FALSE"</span>, <span class="st">"FALSE"</span>), <span class="at">Country =</span> <span class="fu">c</span>(<span class="st">"France"</span>, <span class="st">"France"</span>, <span class="st">"Germany"</span>, <span class="st">"Netherlands"</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the column names from the initial dataframe</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">colnames</span>(Messy_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ID"          "Year"        "Cool.Domain" "Frequency"   "Alive"      
[6] "Country"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleaning the column names</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>Messy_data <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(Messy_data)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">colnames</span>(Messy_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "id"          "year"        "cool_domain" "frequency"   "alive"      
[6] "country"    </code></pre>
</div>
</div>
<p>You can see that capital letter have been adjusted, some characters (µ, “)” ) have been replaced, spaces have been removed and replaced with “_“. This makes it easier and faster to refer to the columns and the dataframes when manipulating the data on a day-to-day basis.</p>
<p>Once we are happy with the data formats we can move on take care of other issues.</p>
<section id="data-transformation" class="level4">
<h4 class="anchored" data-anchor-id="data-transformation">Data transformation</h4>
<p>It often happens that we are not fully happy with the data that we receive or simply that we need apply some modifications to suit our needs. The most frequent of these operations are</p>
<ul>
<li>Mathematical transformation of numerical data (multiplication, rounding up)</li>
<li>Extract years, days or months from dates</li>
<li>Trim whitespaces from data</li>
<li>Rename categories within the data</li>
</ul>
<p>The main difficulty with the actions is to identify how to apply the functions. Some functions can be applied directly to a whole column while other nedd to be applied using mapping functions. Let’s start with mathematical transformations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we start by creating a dataset to work with</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Identifier =</span> <span class="fu">c</span>(<span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"ID3"</span>, <span class="st">"ID4 "</span>), <span class="at">Date =</span> <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">2003</span>, <span class="dv">2009</span>, <span class="dv">2010</span>), <span class="at">Domain =</span> <span class="fu">c</span>(<span class="st">"B60C"</span>, <span class="st">"B29K"</span>,<span class="st">"B29K "</span>, <span class="st">"B60C"</span>), <span class="at">Distance =</span> <span class="fu">c</span>(<span class="fl">62.1371</span>, <span class="fl">124.274</span>, <span class="fl">93.2057</span>, <span class="fl">186.411</span>), <span class="at">Active =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>), <span class="at">Country =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"France"</span>, <span class="st">"France"</span>, <span class="st">"Germany"</span>, <span class="st">"Netherlands"</span>)))</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The Distance is given in miles in this data, we would like to have kilometers. The formula to transform a mile to kilometers is a multiplication by 1.609.</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>KM <span class="ot">&lt;-</span> data<span class="sc">$</span>Distance <span class="sc">*</span> <span class="fl">1.609344</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Identifier Date Domain Distance Active     Country        KM
1        ID1 2002   B60C  62.1371   TRUE      France  99.99997
2        ID2 2003   B29K 124.2740  FALSE      France 199.99962
3        ID3 2009  B29K   93.2057  FALSE     Germany 150.00003
4       ID4  2010   B60C 186.4110  FALSE Netherlands 299.99942</code></pre>
</div>
</div>
<p>We can also round this up. The <strong>round()</strong> function takes two arguments, a first will be the data, the second will be the number of decimals:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>KM <span class="ot">&lt;-</span> <span class="fu">round</span>(data<span class="sc">$</span>KM, <span class="dv">2</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Identifier Date Domain Distance Active     Country  KM
1        ID1 2002   B60C  62.1371   TRUE      France 100
2        ID2 2003   B29K 124.2740  FALSE      France 200
3        ID3 2009  B29K   93.2057  FALSE     Germany 150
4       ID4  2010   B60C 186.4110  FALSE Netherlands 300</code></pre>
</div>
</div>
<p>We notice that for some of the domains there is a trailing whitespace, for example we have “B29K” in the data. These can be removed with the <strong>trimws()</strong> function. These whitespaces can also be created when we split data. It’s good practise to always check this and remove any space to avoid unnecessary mistakes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Domain <span class="ot">&lt;-</span> <span class="fu">trimws</span>(data<span class="sc">$</span>Domain)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Identifier Date Domain Distance Active     Country  KM
1        ID1 2002   B60C  62.1371   TRUE      France 100
2        ID2 2003   B29K 124.2740  FALSE      France 200
3        ID3 2009   B29K  93.2057  FALSE     Germany 150
4       ID4  2010   B60C 186.4110  FALSE Netherlands 300</code></pre>
</div>
</div>
<p>Suppose that we want to change the labels for the countries. It’s much more common to use ISO-2 level codes for countries. The <strong>gsub()</strong> function for the replacement of text. The <strong>gsub()</strong> function requires three arguments: the patter to search, the pattern to replace with and the data. Caution while using this function since it searches for the pattern even withing words. If one searches for the string “land” to replace it with “country”, then the string “netherlands” will become “nethercountrys”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter()  masks stats::filter()
✖ purrr::flatten() masks jsonlite::flatten()
✖ dplyr::lag()     masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"France"</span>, <span class="st">"FR"</span>, data<span class="sc">$</span>Country)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Netherlands"</span> , <span class="st">"NL"</span>,data<span class="sc">$</span>Country)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"Germany"</span> ,<span class="st">"DE"</span>,data<span class="sc">$</span>Country)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Identifier Date Domain Distance Active Country  KM
1        ID1 2002   B60C  62.1371   TRUE      FR 100
2        ID2 2003   B29K 124.2740  FALSE      FR 200
3        ID3 2009   B29K  93.2057  FALSE      DE 150
4       ID4  2010   B60C 186.4110  FALSE      NL 300</code></pre>
</div>
</div>
<p>In the special case of categorical variables, we can also use the <strong>dplyr</strong> package to replace strings using the <strong>case_when</strong> function. It is a flexible and powerful function that allows you to perform conditional operations on a vector or data frame, similar to a series of nested if-else statements. It’s especially useful when you need to create or modify variables in your data based on specific conditions. The syntax follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">case_when</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  condition1 <span class="sc">~</span> result1,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  condition2 <span class="sc">~</span> result2,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  condition3 <span class="sc">~</span> result3,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  ...</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the case of changing categories, if we want to switch the name of the country for the ISO identifyers of the countries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Identifier =</span> <span class="fu">c</span>(<span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"ID3"</span>, <span class="st">"ID4 "</span>), <span class="at">Date =</span> <span class="fu">c</span>(<span class="dv">2002</span>, <span class="dv">2003</span>, <span class="dv">2009</span>, <span class="dv">2010</span>), <span class="at">Domain =</span> <span class="fu">c</span>(<span class="st">"B60C"</span>, <span class="st">"B29K"</span>,<span class="st">"B29K "</span>, <span class="st">"B60C"</span>), <span class="at">Distance =</span> <span class="fu">c</span>(<span class="fl">62.1371</span>, <span class="fl">124.274</span>, <span class="fl">93.2057</span>, <span class="fl">186.411</span>), <span class="at">Active =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>), <span class="at">Country =</span> <span class="fu">as.factor</span>(<span class="fu">c</span>(<span class="st">"France"</span>, <span class="st">"France"</span>, <span class="st">"Germany"</span>, <span class="st">"Netherlands"</span>)))</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Country <span class="ot">&lt;-</span> <span class="fu">case_when</span>(</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">"France"</span> <span class="sc">~</span> <span class="st">"FR"</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">"Netherlands"</span> <span class="sc">~</span> <span class="st">"NL"</span>,</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>Country <span class="sc">==</span> <span class="st">"Germany"</span> <span class="sc">~</span> <span class="st">"DE"</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Identifier Date Domain Distance Active Country
1        ID1 2002   B60C  62.1371   TRUE      FR
2        ID2 2003   B29K 124.2740  FALSE      FR
3        ID3 2009  B29K   93.2057  FALSE      DE
4       ID4  2010   B60C 186.4110  FALSE      NL</code></pre>
</div>
</div>
</section>
</section>
<section id="extract-substrings" class="level3">
<h3 class="anchored" data-anchor-id="extract-substrings">Extract substrings</h3>
</section>
<section id="missing-values" class="level3">
<h3 class="anchored" data-anchor-id="missing-values">Missing values</h3>
<p>It is common to encounter missing values in your data. There are multiple methods to deal with missing data ranging for simply removing them to using statistical methods to replace the missing values with other values. Whatever you decide to do with your missing data, think thoroughly about the consequences. Always consider why the data is missing, are the missing observations random or is there a pattern to the missing observations? For example if, suppose we are working on a dataset with pollution measurements around the world. It’s possible that missing values come from countries in a specific region of the world. Removing these observations will result in excluding a whole region from the analysis. If the missing observations are more randomly dispersed over different regions in the world this might be less of an issue. The first step to take when dealing with missing values is to check for patterns in the data. Based on the type of missing values you are dealing with, you can decide to on the most efficient method to treat them:</p>
<ul>
<li>Remove the missing values</li>
<li>Linear interpolation</li>
<li>K-means</li>
</ul>
<p><a href="https://tmb.njtierney.com/missing-gotchyas">This book on missing values</a> and <a href="https://bookdown.org/mike/data_analysis/imputation-missing-data.html">This book with a chapter on how to handle this king of data</a></p>
</section>
</section>
<section id="data-conformity-in-python" class="level2">
<h2 class="anchored" data-anchor-id="data-conformity-in-python">Data conformity in Python</h2>
<p>Before you start working on your analysis, you want to make sure the data is conform to your expectations. This means:</p>
<ul>
<li><p>The number of observation is correct, and the variables you need are included.</p></li>
<li><p>Making sure each column is of the right type (years are dates, text are factors, numbers are integers or reals, …)</p></li>
<li><p>There are no trailing spaces</p></li>
<li><p><strong>“.”</strong> and <strong>“,”</strong> aren’t mixed up</p></li>
<li><p>The units of measurement are correct (km vs.&nbsp;miles, K€ vs 1.000, celsius vs fahrenheit etc.)</p></li>
<li><p>Any missing values have been dealt with, or you have a valid reason to ignore them</p></li>
<li><p>headers are easy to use (no spaces or other characters that will make your life difficult).</p></li>
</ul>
<p>In this section we will look into checking your data and adjusting it in preparation of your analysis.</p>
<section id="checking-data-types-1" class="level3">
<h3 class="anchored" data-anchor-id="checking-data-types-1">Checking data types</h3>
<p>There are many different data formats. Most frequently we encounter numbers, strings, factors, dates and booleans. Consider the following dataset:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">ID</th>
<th style="text-align: center;">Year</th>
<th style="text-align: center;">Cool Domain</th>
<th style="text-align: center;">Frequency</th>
<th style="text-align: center;">Alive</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">ID1</td>
<td style="text-align: center;">2002</td>
<td style="text-align: center;">B60C</td>
<td style="text-align: center;">42</td>
<td style="text-align: center;">TRUE</td>
</tr>
<tr class="even">
<td style="text-align: center;">ID2</td>
<td style="text-align: center;">2003</td>
<td style="text-align: center;">B29K</td>
<td style="text-align: center;">21</td>
<td style="text-align: center;">FALSE</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ID3</td>
<td style="text-align: center;">2009</td>
<td style="text-align: center;">C08K</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">TRUE</td>
</tr>
</tbody>
</table>
<p>The first column has textual data that is used as a key for each row. The Year should be considered either as an integer or a date. This will depend upon the type of analysis you want to perform. Specifically time series analysis will require this to be a date, while it’s enough for other analyses to ensure that it is an integer. The most common issue with this type of observation is that the year is considered as text instead of a number. If you see any ““” next to your numbers this is a bad sign which indicates that it is in fact, text.</p>
<p>The “Cool Domain” contains classifications which we want to be textual values. “Frequency” will need to be an integer while “Alive” we want to be a boolean. For each of the formats there is a function to test whether or not the format is the one we expect. These functions are usually in the form of <strong>is_numeric_dtype()</strong>, <strong>is_bool_dtype()</strong>, <strong>is_string_dtype()</strong>. The argument is then simply the column of the dataframe or an observation. Suppose we create the previous dataframe in Python:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'ID'</span> : [<span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"ID3"</span>], </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Year'</span> : [<span class="dv">2002</span>, <span class="dv">2003</span>, <span class="dv">2009</span>], </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Cool Domain'</span> : [<span class="st">"B60C"</span>, <span class="st">"B29K"</span>,<span class="st">"B29K"</span>], </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Frequency'</span> : [<span class="dv">42</span>, <span class="dv">21</span>, <span class="dv">12</span>],</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Alive'</span> : [<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>]</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>dataframe <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co"># check if the information in the column Year is numeric</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>pd.api.types.is_numeric_dtype(dataframe[<span class="st">'Year'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if the information in the column is logic</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>pd.api.types.is_bool_dtype(dataframe[<span class="st">'Alive'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if the information in the column is character</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>pd.api.types.is_string_dtype(dataframe[<span class="st">'ID'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True</code></pre>
</div>
</div>
<ul>
<li>pd: This is an alias for the pandas library, which is a popular data manipulation library in Python. The alias is used for convenience.</li>
<li>api: This is the namespace within the pandas library where various utility functions and types are organized. It’s considered part of the public API of the library, which means that it’s stable and can be used by developers without concerns about major changes between different versions of pandas.</li>
<li>types: This is a subnamespace within the api namespace that provides functions and types related to data types and data type checking.</li>
<li>is_numeric_dtype(): This is a function provided by the pandas library in the types subnamespace. It’s used to check if a given data type is numeric.</li>
</ul>
<p>This can also be done in a more consise way with the <strong>dataframe.describe()</strong> function. This compute, for each of the columns, some statistics and provides the class of the class of the variables. This comes in handy as it allows us verify not only the class of the variables but also the distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'ID'</span> : [<span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"ID3"</span>], </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Year'</span> : [<span class="dv">2002</span>, <span class="dv">2003</span>, <span class="dv">2009</span>], </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Cool Domain'</span> : [<span class="st">"B60C"</span>, <span class="st">"B29K"</span>,<span class="st">"B29K"</span>], </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Frequency'</span> : [<span class="dv">42</span>, <span class="dv">21</span>, <span class="dv">12</span>],</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Alive'</span> : [<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>]</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>dataframe <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>dataframe.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Year  Frequency
count     3.000000   3.000000
mean   2004.666667  25.000000
std       3.785939  15.394804
min    2002.000000  12.000000
25%    2002.500000  16.500000
50%    2003.000000  21.000000
75%    2006.000000  31.500000
max    2009.000000  42.000000</code></pre>
</div>
</div>
<p>Missing values in a dataframe will be automatically ignored. We can also check the types of each variable to ensure that it corresponds to what we want (integers are integers, text is text, etc). The latter can be done with the <strong>.dftypes</strong> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'ID'</span> : [<span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"ID3"</span>, <span class="st">"ID4"</span>], </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Year'</span> : [<span class="dv">2002</span>, <span class="dv">2003</span>, <span class="dv">2009</span>, <span class="dv">2010</span>], </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Cool Domain'</span> : [<span class="st">"B60C"</span>, <span class="st">"B29K"</span>,<span class="st">"B29K"</span>, <span class="st">"B60C"</span>], </span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Frequency'</span> : [<span class="dv">42</span>, <span class="dv">21</span>, <span class="dv">12</span>, <span class="va">None</span>],</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Weight'</span> : [<span class="fl">12.1</span>, <span class="fl">34.2</span>, <span class="fl">21.3</span>, <span class="fl">93.2</span>],</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Alive'</span> : [<span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>, <span class="va">False</span>],</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Country'</span> : [<span class="st">"France"</span>, <span class="st">"France"</span>, <span class="st">"Germany"</span>, <span class="st">"Netherlands"</span>]</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>df.describe()</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this output we can see that the <strong>None</strong> value is ignored and the statistics are computed. The format of the variables is shown: ID is considered “object” signifying that has no specific nature (object is a generic format for anything used in Python). <em>int64</em> represents an integer, <em>float64</em> represents a reel number, <em>bool</em> is a boolean operator.</p>
<p>Given that we created the dataframe ourselves we can be relatively sure that the data was is the right format. However, often enough when we download data from online sources, we run into issues. If the format is not as expected there are different functions that allows us to transform the format of the data. Mainly we use <strong>.astype(float)</strong>, <strong>.astype(int)</strong> and <strong>.astype(str)</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'ID'</span> : [<span class="st">"ID1"</span>, <span class="st">"ID2"</span>, <span class="st">"ID3"</span>, <span class="st">"ID4"</span>], </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Year'</span> : [<span class="dv">2002</span>, <span class="dv">2003</span>, <span class="dv">2009</span>, <span class="dv">2010</span>], </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Cool Domain'</span> : [<span class="st">"B60C"</span>, <span class="st">"B29K"</span>,<span class="st">"B29K"</span>, <span class="st">"B60C"</span>], </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Frequency'</span> : [<span class="dv">42</span>, <span class="dv">21</span>, <span class="dv">12</span>, <span class="dv">12</span>],</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Weight'</span> : [<span class="fl">12.1</span>, <span class="fl">34.2</span>, <span class="fl">21.3</span>, <span class="fl">93.2</span>],</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Alive'</span> : [<span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>, <span class="va">False</span>],</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Country'</span> : [<span class="st">"France"</span>, <span class="st">"France"</span>, <span class="st">"Germany"</span>, <span class="st">"Netherlands"</span>]</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the data type of 'ID' to string</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'ID'</span>] <span class="op">=</span> df[<span class="st">'ID'</span>].astype(<span class="bu">str</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the data type of 'Weight' to uppercase string</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Weight'</span>] <span class="op">=</span> df[<span class="st">'Weight'</span>].astype(<span class="bu">float</span>)</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the data type of 'Frequency' to int</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="co"># We first need to take care of the missing value</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Frequency'</span>] <span class="op">=</span> df[<span class="st">'Frequency'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ID              object
Year             int64
Cool Domain     object
Frequency        int64
Weight         float64
Alive             bool
Country         object
dtype: object</code></pre>
</div>
</div>
<p>Now that our data has the right format and we are sure we have all the observations we might want to do some work to normalise the column names. This is done to make programming and refercing the columns easier. Whenever the is a space in the name of the column, we need to refer to the column using <strong>`Column name with spaces`</strong> which is not ideal. It’s generally good practice to not have any spaces. We can use the <strong>pyjanitor</strong> package to automate this process:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> janitor</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">'Column 1'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="va">None</span>, <span class="dv">4</span>],</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Column (2)'</span>: [<span class="va">None</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>],</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'PM(µ &gt;3)'</span>: [<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]}</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Column 1  Column (2)  PM(µ &gt;3)
0       1.0         NaN         9
1       2.0         6.0        10
2       NaN         7.0        11
3       4.0         8.0        12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using clean_pandas</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.clean_names()</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   column_1  column_2_  pm_µ_&gt;3_
0       1.0        NaN         9
1       2.0        6.0        10
2       NaN        7.0        11
3       4.0        8.0        12</code></pre>
</div>
</div>
</section>
<section id="data-transformation-1" class="level3">
<h3 class="anchored" data-anchor-id="data-transformation-1">Data transformation</h3>
<!-- It often happens that we are not fully happy with the data that we receive or simply that we need apply some modifications to suit our needs. The most frequent of these operations are -->
<!-- -   Mathematical transformation of numerical data (multiplication, rounding up) -->
<!-- -   Extract years, days or months from dates -->
<!-- -   Trim whitespaces from data -->
<!-- -   Rename categories within the data -->
<!-- The main difficulty with the actions is to identify how to apply the functions. Some functions can be applied directly to a whole column while other nedd to be applied using mapping functions. Let's start with mathematical transformations: -->
<!-- ```{r, eval = FALSE} -->
<!-- # we start by creating a dataset to work with -->
<!-- data <- data.frame(Identifier = c("ID1", "ID2", "ID3", "ID4 "), Date = c(2002, 2003, 2009, 2010), Domain = c("B60C", "B29K","B29K ", "B60C"), Distance = c(62.1371, 124.274, 93.2057, 186.411), Active = c(TRUE, FALSE, FALSE, FALSE), Country = as.factor(c("France", "France", "Germany", "Netherlands"))) -->
<!-- # The Distance is given in miles in this data, we would like to have kilometers. The formula to transform a mile to kilometers is a multiplication by 1.609. -->
<!-- data$KM <- data$Distance * 1.609344 -->
<!-- print(data) -->
<!-- ``` -->
<!-- We can also round this up. The **round()** function takes two arguments, a first will be the data, the second will be the number of decimals: -->
<!-- ```{r, eval = FALSE} -->
<!-- data$KM <- round(data$KM, 2) -->
<!-- print(data) -->
<!-- ``` -->
<!-- We notice that for some of the domains there is a trailing whitespace, for example we have "B29K" in the data. These can be removed with the **trimws()** function. These whitespaces can also be created when we split data. It's good practise to always check this and remove any space to avoid unnecessary mistakes. -->
<!-- ```{r, eval = FALSE} -->
<!-- data$Domain <- trimws(data$Domain) -->
<!-- print(data) -->
<!-- ``` -->
<!-- Suppose that we want to change the labels for the countries. It's much more common to use ISO-2 level codes for countries. The **gsub()** function for the replacement of text. The **gsub()** function requires three arguments: the patter to search, the pattern to replace with and the data. Caution while using this function since it searches for the pattern even withing words. If one searches for the string "land" to replace it with "country", then the string "netherlands" will become "nethercountrys". -->
<!-- ```{r, eval = FALSE} -->
<!-- library(tidyverse) -->
<!--   data$Country <- gsub("France", "FR", data$Country) -->
<!--   data$Country <- gsub("Netherlands" , "NL",data$Country) -->
<!--   data$Country <- gsub("Germany" ,"DE",data$Country) -->
<!-- print(data) -->
<!-- ``` -->
<!-- In the special case of categorical variables, we can also use the **dplyr** package to replace strings using the **case_when** function. It is a flexible and powerful function that allows you to perform conditional operations on a vector or data frame, similar to a series of nested if-else statements. It's especially useful when you need to create or modify variables in your data based on specific conditions. The syntax follows: -->
<!-- ```{r, eval = FALSE} -->
<!-- case_when( -->
<!--   condition1 ~ result1, -->
<!--   condition2 ~ result2, -->
<!--   condition3 ~ result3, -->
<!--   ... -->
<!-- ) -->
<!-- ``` -->
<!-- In the case of changing categories, if we want to switch the name of the country for the ISO identifyers of the countries: -->
<!-- ```{r, eval = FALSE} -->
<!-- library(tidyverse) -->
<!-- data <- data.frame(Identifier = c("ID1", "ID2", "ID3", "ID4 "), Date = c(2002, 2003, 2009, 2010), Domain = c("B60C", "B29K","B29K ", "B60C"), Distance = c(62.1371, 124.274, 93.2057, 186.411), Active = c(TRUE, FALSE, FALSE, FALSE), Country = as.factor(c("France", "France", "Germany", "Netherlands"))) -->
<!-- data$Country <- case_when( -->
<!--   data$Country == "France" ~ "FR", -->
<!--   data$Country == "Netherlands" ~ "NL", -->
<!--   data$Country == "Germany" ~ "DE" -->
<!-- ) -->
<!-- print(data) -->
<!-- ``` -->


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>